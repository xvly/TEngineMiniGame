# TEngine 框架概览

## 🏗️ 架构设计

TEngine 是一个基于 **GameFramework** 优化、最简化以及商业化适配的 Unity 游戏框架。框架采用**面向接口编程**的设计理念，提供了高内聚、低耦合的模块化架构。

![image](src/2-1.png)

---

## 🎯 设计理念

### 面向接口编程

框架思路为面向接口编程，以 Resource 资源模块为例：

1. **定义接口规范**：先定义 `IResourceManager` 的接口规范
2. **实现具体功能**：编写 `ResourceManager` 继承框架具体实现（`ModuleImp`）以及实现接口
3. **调用层封装**：实现调用层 `Module`，调用层可以拓展编辑器供开发者自定义模块参数

### 模块化设计

```csharp
/// <summary>
/// 游戏框架模块抽象类。ModuleImp 为具体框架模块实现。
/// </summary>
internal abstract class ModuleImp
{
    /// <summary>
    /// 获取游戏框架模块优先级。
    /// </summary>
    /// <remarks>优先级较高的模块会优先轮询，并且关闭操作会后进行。</remarks>
    internal virtual int Priority => 0;

    /// <summary>
    /// 游戏框架模块轮询。
    /// </summary>
    /// <param name="elapseSeconds">逻辑流逝时间，以秒为单位。</param>
    /// <param name="realElapseSeconds">真实流逝时间，以秒为单位。</param>
    internal abstract void Update(float elapseSeconds, float realElapseSeconds);

    /// <summary>
    /// 关闭并清理游戏框架模块。
    /// </summary>
    internal abstract void Shutdown();
}

//=====================================================================//

/// <summary>
/// 游戏框架模块抽象类。Module 为 Mono 调用层。
/// </summary>
public abstract class Module : MonoBehaviour
{
    /// <summary>
    /// 游戏框架模块初始化。
    /// </summary>
    protected virtual void Awake()
    {
        ModuleSystem.RegisterModule(this);
    }
}
```

---

## 📦 核心模块

### 1. 资源模块 (ResourceModule)

**核心优势**：
- 🔗 **资源引用自动化管理**：通过 `AssetsReference` 组件自动管理资源生命周期
- 📊 **上层资源管理框架**：基于 YooAsset 构建，提供更高层次的抽象
- 🎯 **商业级内存管理**：支持 LRU、ARC 缓存策略，自动释放资源

**详细文档**：[资源模块文档](./3-1-资源模块.md)

### 2. 事件模块 (GameEvent)

**核心优势**：
- ⚡ **零 GC 设计**：使用 int 类型事件 ID，避免字符串哈希计算
- 🎯 **生命周期自动管理**：UI 模块的事件和 UI 生命周期存在绑定
- 📊 **支持 MVE 架构**：配合 UI 模块实现 Model-View-Event 事件驱动架构

**详细文档**：[事件模块文档](./3-2-事件模块.md)

### 3. UI 模块 (UIModule)

**核心优势**：
- 🚀 **轻量级设计**：纯 C# 实现，完全脱离 Mono 的生命周期
- 🔧 **极高的可拓展性**：模块化架构，灵活的生命周期管理
- 💡 **代码自动生成**：一键生成 UI 绑定代码，提升开发效率

**详细文档**：[UI 模块文档](./3-5-UI模块.md)

### 4. 配置表模块 (ConfigSystem)

**核心优势**：
- 🚀 **多种加载方式**：支持懒加载、异步加载、同步加载
- 📦 **强大的数据支持**：支持 Excel、JSON、XML 等多种格式
- ✅ **完善的数据校验**：ref 引用检查、path 资源路径检查等

**详细文档**：[配置表模块文档](./3-6-配置表模块.md)

### 5. 流程模块 (ProcedureModule)

**核心优势**：
- 📋 **完整的商业化流程**：覆盖从启动到进入游戏的完整流程
- 🔄 **状态机模式**：清晰的流程状态管理，易于扩展和维护
- 🚀 **异步流程支持**：基于 UniTask 的异步流程

**详细文档**：[流程模块文档](./3-7-流程模块.md)

### 6. 内存池模块 (MemoryPool)

**核心优势**：
- 🚀 **轻量级设计**：极小的内存占用，快速的对象获取和释放
- 🔄 **自动对象复用**：减少内存分配和 GC 压力

**详细文档**：[内存池模块文档](./3-3-内存池模块.md)

### 7. 对象池模块 (ObjectModule)

**核心优势**：
- 🔄 **对象复用**：减少 GameObject 的创建和销毁
- 🎯 **灵活的对象池类型**：支持单次/多次获取对象池

**详细文档**：[对象池模块文档](./3-4-对象池模块.md)

---

## 🔥 热更新域程序集设计

### 程序集结构

```
Assets/GameScripts
├── Main                // 主程序程序集（启动器与流程）
└── HotFix              // 游戏热更程序集目录 [Folder]
    ├── GameBase        // 游戏基础框架程序集 [Dll]
    ├── GameProto       // 游戏配置协议程序集 [Dll]
    └── GameLogic       // 游戏业务逻辑程序集 [Dll]
        ├── GameApp.cs                  // 热更主入口
        └── GameApp_RegisterSystem.cs   // 热更主入口注册系统
```

### 设计说明

- **Main**：主程序程序集，包含启动器和流程管理
- **GameBase**：游戏基础框架程序集，存放通用性逻辑
- **GameProto**：游戏配置协议程序集，存放与服务器交互的协议以及配置表逻辑
- **GameLogic**：游戏业务逻辑程序集，存放主要玩法逻辑和 UI

> **提示**：若有项目需求完全可以进行自定义增删 HotFix 程序集。注意增删程序集后需要同步到 HybridCLR 的 Setting 面板以及 TEngineSetting 的面板。TEngineSettings 面板有按钮可以从 HybridCLR 中同步 AOT 与热更程序集。

---

## 🎯 MVE 架构支持

TEngine 框架支持 **MVE（Model - View - Event）事件驱动架构**：

- **Model**：数据模型层，管理游戏数据
- **View**：视图层，UI 模块负责视图展示
- **Event**：事件层，事件模块负责模块间通信

通过事件系统解耦 Model 和 View，实现高内聚、低耦合的架构设计。

---

## 📚 模块文档导航

| 模块 | 文档 | 描述 |
|------|------|------|
| 📦 **资源模块** | [3-1-资源模块](./3-1-资源模块.md) | 资源引用自动化管理，上层资源管理框架 |
| 🎯 **事件模块** | [3-2-事件模块](./3-2-事件模块.md) | 零 GC 事件系统，MVE 架构支持 |
| 💾 **内存池模块** | [3-3-内存池模块](./3-3-内存池模块.md) | 轻量级内存池管理 |
| 🎮 **对象池模块** | [3-4-对象池模块](./3-4-对象池模块.md) | 游戏对象池管理 |
| 🎨 **UI 模块** | [3-5-UI模块](./3-5-UI模块.md) | 轻量级、高可拓展性 UI 框架 |
| 📊 **配置表模块** | [3-6-配置表模块](./3-6-配置表模块.md) | Luban 配置表系统 |
| 🔄 **流程模块** | [3-7-流程模块](./3-7-流程模块.md) | 商业化启动流程 |
| 🌐 **网络模块** | [3-8-网络模块](./3-8-网络模块.md) | 网络通信模块 |

---

## 🔗 相关链接

- [快速开始指南](./1-快速开始.md) - 5 分钟快速上手
- [介绍文档](./0-介绍.md) - 了解 TEngine 核心特性
